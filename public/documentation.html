<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }
        h1 { color: #333; }
        h2 { color: #555; }
        code { background: #f4f4f4; padding: 2px 4px; border-radius: 4px; }
        pre { background: #f4f4f4; padding: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>API Documentation</h1>
    <p>Base URL: <code>http://localhost:8080</code></p>

    <h2>Endpoints</h2>

    <h3>Movie Endpoints</h3>

    <h4>Get All Movies</h4>
    <p><strong>URL:</strong> <code>/movies</code></p>
    <p><strong>Method:</strong> GET</p>
    <p><strong>Description:</strong> Retrieves a list of all movies.</p>
    <pre>
    <code>
    Response:
    Status: 200 OK
    [
        {
            "_id": "664a6b0e0f0177a700e79dc7",
            "Title": "The Lion King",
            "Description": "Lion prince Simba and his father are targeted by his bitter uncle, who wants to ascend the throne himself.",
            "Genre": {
                "Name": "Animation",
                "Description": "Animation film is a genre in which the images are primarily created through animation techniques."
            },
            "Director": {
                "Name": "Roger Allers and Rob Minkoff",
                "Bio": "Roger Allers is an American film director, screenwriter, and animator. Rob Minkoff is an American filmmaker.",
                "Birth": "1949 (Allers), 1962 (Minkoff)"
            },
            "ImagePath": "lionking.png",
            "Featured": true,
            "movieId": "00010"
        }
    ]
    </code>
    </pre>

    <h4>Get Movie by Title</h4>
    <p><strong>URL:</strong> <code>/movies/:Title</code></p>
    <p><strong>Method:</strong> GET</p>
    <p><strong>Description:</strong> Retrieves details of a specific movie by its title.</p>
    <p><strong>URL Parameters:</strong> <code>Title</code> (string) - The title of the movie to retrieve.</p>
    <pre>
    <code>
    Response (if movie is found):
    Status: 200 OK
    {
        "_id": "664a6b0e0f0177a700e79dc7",
        "Title": "The Lion King",
        "Description": "Lion prince Simba and his father are targeted by his bitter uncle, who wants to ascend the throne himself.",
        "Genre": {
            "Name": "Animation",
            "Description": "Animation film is a genre in which the images are primarily created through animation techniques."
        },
        "Director": {
            "Name": "Roger Allers and Rob Minkoff",
            "Bio": "Roger Allers is an American film director, screenwriter, and animator. Rob Minkoff is an American filmmaker.",
            "Birth": "1949 (Allers), 1962 (Minkoff)"
        },
        "ImagePath": "lionking.png",
        "Featured": true,
        "movieId": "00010"
    }

    Response (if movie is not found):
    Status: 404 Not Found
    Movie not found
    </code>
    </pre>

    <h4>Add a New Movie</h4>
    <p><strong>URL:</strong> <code>/movies</code></p>
    <p><strong>Method:</strong> POST</p>
    <p><strong>Description:</strong> Adds a new movie to the list of movies.</p>
    <p><strong>Request Body:</strong></p>
    <pre>
    <code>
    {
        "Title": "New Movie",
        "Description": "Description of the new movie",
        "Genre": {
            "Name": "Genre Name",
            "Description": "Genre Description"
        },
        "Director": {
            "Name": "Director Name",
            "Bio": "Director Bio",
            "Birth": "YYYY"
        },
        "Actors": ["Actor 1", "Actor 2"],
        "ImagePath": "path/to/image",
        "Featured": true
    }
    </code>
    </pre>
    <pre>
    <code>
    Response (if movie is successfully added):
    Status: 201 Created
    {
        "_id": "generated-uuid",
        "Title": "New Movie",
        "Description": "Description of the new movie",
        "Genre": {
            "Name": "Genre Name",
            "Description": "Genre Description"
        },
        "Director": {
            "Name": "Director Name",
            "Bio": "Director Bio",
            "Birth": "YYYY"
        },
        "Actors": ["Actor 1", "Actor 2"],
        "ImagePath": "path/to/image",
        "Featured": true
    }

    Response (if request body is missing or invalid):
    Status: 400 Bad Request
    No movie data in request body
    </code>
    </pre>

    <h4>Update Movie Genre</h4>
    <p><strong>URL:</strong> <code>/movies/:Title</code></p>
    <p><strong>Method:</strong> PUT</p>
    <p><strong>Description:</strong> Updates the genre of a specific movie by its title.</p>
    <p><strong>URL Parameters:</strong> 
        <code>Title</code> (string) - The title of the movie to update.<br>
    </p>
    <p><strong>Request Body:</strong></p>
    <pre>
    <code>
    {
        "Name": "New Genre Name",
        "Description": "New Genre Description"
    }
    </code>
    </pre>
    <pre>
    <code>
    Response (if movie is found and updated):
    Status: 200 OK
    Genre details updated

    Response (if movie is not found):
    Status: 404 Not Found
    Movie not found
    </code>
    </pre>

    <h4>Delete Movie by ID</h4>
    <p><strong>URL:</strong> <code>/movies/:id</code></p>
    <p><strong>Method:</strong> DELETE</p>
    <p><strong>Description:</strong> Deletes a movie from the list by its ID.</p>
    <p><strong>URL Parameters:</strong> <code>id</code> (string) - The ID of the movie to delete.</p>
    <pre>
    <code>
    Response (if movie is found and deleted):
    Status: 200 OK
    Movie deleted

    Response (if movie is not found):
    Status: 404 Not Found
    Movie not found
    </code>
    </pre>

    <h3>User Endpoints</h3>

    <h4>Get All Users</h4>
    <p><strong>URL:</strong> <code>/users</code></p>
    <p><strong>Method:</strong> GET</p>
    <p><strong>Description:</strong> Retrieves a list of all users.</p>
    <pre>
    <code>
    Response:
    Status: 200 OK
    [
        {
            "_id": "666c3c644ef27683b90612a5",
            "Username": "Test4",
            "Email": "test@test2.com",
            "Password": "$2b$10$N3YIiEJ8uSf/WQwAh4Stdu8/KowfZ0Ur6J7qYVoZs.C9Cq/h80FY2",
            "Role": "user",
            "FavouriteMovies": [],
            "__v": 0
        }
    ]
    </code>
    </pre>

    <h4>Get User by ID</h4>
    <p><strong>URL:</strong> <code>/users/:id</code></p>
    <p><strong>Method:</strong> GET</p>
    <p><strong>Description:</strong> Retrieves details of a specific user by their ID.</p>
    <p><strong>URL Parameters:</strong> <code>id</code> (string) - The ID of the user to retrieve.</p>
    <pre>
    <code>
    Response (if user is found):
    Status: 200 OK
    {
        "_id": "666c3c644ef27683b90612a5",
        "Username": "Test4",
        "Email": "test@test2.com",
        "Password": "$2b$10$N3YIiEJ8uSf/WQwAh4Stdu8/KowfZ0Ur6J7qYVoZs.C9Cq/h80FY2",
        "Role": "user",
        "FavouriteMovies": [],
        "__v": 0
    }

    Response (if user is not found):
    Status: 404 Not Found
    User not found
    </code>
    </pre>

    <h4>Add a New User</h4>
    <p><strong>URL:</strong> <code>/users</code></p>
    <p><strong>Method:</strong> POST</p>
    <p><strong>Description:</strong> Adds a new user.</p>
    <p><strong>Request Body:</strong></p>
    <pre>
    <code>
    {
        "Username": "newuser",
        "Password": "password123",
        "Email": "newuser@example.com"
    }
    </code>
    </pre>
    <pre>
    <code>
    Response (if user is successfully added):
    Status: 201 Created
    {
        "_id": "generated-uuid",
        "Username": "newuser",
        "Email": "newuser@example.com",
        "Password": "$2b$10$N3YIiEJ8uSf/WQwAh4Stdu8/KowfZ0Ur6J7qYVoZs.C9Cq/h80FY2",
        "Role": "user",
        "FavouriteMovies": [],
        "__v": 0
    }

    Response (if request body is missing or invalid):
    Status: 400 Bad Request
    Username or email already exists
    </code>
    </pre>

    <h4>Update User</h4>
    <p><strong>URL:</strong> <code>/users/:id</code></p>
    <p><strong>Method:</strong> PUT</p>
    <p><strong>Description:</strong> Updates any of the values on the user record except for the password.</p>
    <p><strong>URL Parameters:</strong> <code>id</code> (string) - The ID of the user to update.</p>
    <p><strong>Request Body:</strong> Fields to update (at least one is required).</p>
    <pre>
    <code>
    {
        "Username": "updateduser",
        "Email": "updateduser@example.com"
    }
    </code>
    </pre>
    <pre>
    <code>
    Response (if user is found and updated):
    Status: 200 OK
    User updated

    Response (if user is not found):
    Status: 404 Not Found
    User not found
    </code>
    </pre>

    <h4>Add a Favourite Movie to a User</h4>
    <p><strong>URL:</strong> <code>/users/:id/:movieId</code></p>
    <p><strong>Method:</strong> PUT</p>
    <p><strong>Description:</strong> Adds a favourite movie to a user's list of favourite movies.</p>
    <p><strong>URL Parameters:</strong> 
        <code>id</code> (string) - The ID of the user.<br>
        <code>movieId</code> (string) - The ID of the movie to add.
    </p>
    <pre>
    <code>
    Response (if user is found and movie is added):
    Status: 200 OK
    Movie favourited successfully

    Response (if user is not found):
    Status: 404 Not Found
    User not found
    </code>
    </pre>

    <h4>Delete a Favourite Movie from a User</h4>
    <p><strong>URL:</strong> <code>/users/:id/:movieId</code></p>
    <p><strong>Method:</strong> DELETE</p>
    <p><strong>Description:</strong> Deletes a favourite movie from a user's list by its ID.</p>
    <p><strong>URL Parameters:</strong> 
        <code>id</code> (string) - The ID of the user.<br>
        <code>movieId</code> (string) - The ID of the movie to delete.
    </p>
    <pre>
    <code>
    Response (if user is found and movie is deleted):
    Status: 200 OK
    Favourite movie removed successfully

    Response (if user is not found):
    Status: 404 Not Found
    User not found
    </code>
    </pre>

    <h2>Error Handling</h2>
    <p><strong>500 Internal Server Error:</strong> Catches any internal server errors and responds with a status code 500 and a message "Internal server error".</p>

    <h2>Middleware</h2>
    <p><strong>body-parser:</strong> Parses incoming request bodies in a middleware before your handlers, available under the <code>req.body</code> property.</p>
    <p><strong>morgan:</strong> HTTP request logger middleware for Node.js, configured to write logs to <code>log.txt</code>.</p>

    <h2>Logging</h2>
    <p>Logs all HTTP requests to <code>log.txt</code> using morgan middleware.</p>

    <h2>Static Files</h2>
    <p>Serves static files from the <code>public</code> directory.</p>

</body>
</html>
